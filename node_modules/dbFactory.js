'use strict';
var db = require('mongodb').MongoClient;

/*
 var options = {
 host:
 port:
 db:
 username:
 password:
 collection:
 }
 */

function connect(options) {
    var deferred = q.defer();
    options = {
        host: options.host || 'localhost',
        port: options.port ||  27017,
        db: options.db || 'winescz',
        username: options.username || undefined,
        password: options.password || undefined
    };
    db.connect('mongodb://' + options.host + ':' + options.port + '/' + options.db, function (err, db) {
        if (err) {
            deferred.reject(err);
        } else {
            if (options.username && options.password) {
                db.authenticate(options.username, options.password, function (err) {
                    if (err) {
                        deferred.reject(err);
                    } else {
                        deferred.resolve(db);
                    }
                });
            } else {
                deferred.resolve(db);
            }
        }
    });
    return deferred.promise;
}

module.exports = {
    connect: connect


};