'use strict';
var xlsReader = require("xlsReader");
var q = require('q');

function parseXlsFile(filename) {
    var deferred = q.defer();
    xlsReader(filename).then(parseXlsObject).done(function(val){deferred.resolve(val)});
    return deferred.promise;
}

function parseXlsObject(obj) {
    var output = [];
    for (var sheet in obj.Sheets) {

        if (obj.Sheets.hasOwnProperty(sheet)) {

            for (var cell in obj.Sheets[sheet]) {
                if (obj.Sheets[sheet].hasOwnProperty(cell)) {
                    /*console.log(cell);
                    console.log(obj.Sheets[sheet][cell]);*/


                }
            }

        }
    }
    return output;
}

function parsePosition(pos) {
    var reg = /([A-Z])([0-9]*)/;
    var arr = reg.exec(pos);
    return {row: parseInt(arr[2],10), column: arr[1] }
};

module.exports = {
    parseXlsFile:parseXlsFile,
    parsePosition: parsePosition
};
